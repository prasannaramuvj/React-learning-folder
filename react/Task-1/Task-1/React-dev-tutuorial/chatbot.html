<!DOCTYPE html>
<html>
  <head>
    <title>React Basics</title>
     <style>
      .input-conatiner{
        padding: 12px 15px;
        border-radius: 10px;
        border-width: 1px;
        flex-grow: 1;
      
        }
      .button-click{
          padding: 12px 15px;
          border-radius: 10px;
          background-color: rgb(40, 215, 66);
        }
        .inputs-container{
          display: flex;
          justify-content: center;
          align-items: center;
          gap:5px;
        }
        .js-container{
          max-width: 500px;
          margin: auto;
        }
      

       







      </style>
  </head>

  <body>
    <div class="js-container"></div>

    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>


    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>

    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">
     
     
  
    function ChatInput({chatMessages,setchatMessages}){
      const [inputText , setInputText] = React.useState('');

      function saveInputText(event){
        setInputText(event.target.value);

      }


      async function sendMessage(){

         setInputText('');

        const newChatMessages = [
          ...chatMessages,
          {
          message: inputText,
          sender:'user',
          id :crypto.randomUUID()
          }
        ];

        setchatMessages(newChatMessages);

        setchatMessages([
          ...newChatMessages,
          {
            message:'loading',
            sender: 'robot',
            id:crypto.randomUUID()
          }
        ]);

        const response = await Chatbot.getResponseAsync(inputText);
        setchatMessages([
          ...newChatMessages,
          {
            message:response,
            sender: 'robot',
            id : crypto.randomUUID()
          }
        ]);

        // setInputText('');

      }

       function handleKeyDown(event){
          if(event.key === "Enter"){
            sendMessage()
          }
          else if(event.key === "Escape"){
            setInputText('');
          }

        }
      return(
        <div className="inputs-container">
        <input className="input-conatiner"
         placeholder="Enter the message to chatbot" 
         size="30"
         onChange={saveInputText}
         onKeyDown={handleKeyDown}
         value={inputText}

         />
        <button className="button-click" onClick={sendMessage}>send</button>
        </div>
      );
    }
//------------------------------------------------------------------------------


function Chatmessage({message,sender}){

      return(
        <div>
        {sender === 'robot' &&  (<img src="robot.png" alt="" width="50" />)}
        {message}
        {sender === 'user' && (<img src="user.png" alt="" width="50" />)}
        </div>
      )
    }
//----------------------------------------------------------------------------------
  function Chatmessages({chatMessages}){
   
      return(

      <>
      
        {chatMessages.map((chatMessage)=>{
      return(
        <Chatmessage message = {chatMessage.message}  
        sender = {chatMessage.sender} 
        key = {chatMessage.id} />
      );
       })}
      </>
  );

  }



   
    //--------------------------------------------------------------------------------------------------------------------------------//  



    function App(){

        const [chatMessages , setChatMessages] = React.useState( [
          {
        message:'Hello Chatbot',
        sender :'user',
        id:'id1'
      },{
        message:'Hello ! how can i help You?',
        sender :'robot',
        id:'id2'
      },{
        message:'can you get me today date',
        sender:'user',
        id:'id3'
      },{
        message:'today is september 27',
        sender:'robot',
        id:'id4'
      }
    ]);

      return(
      <>
      < ChatInput chatMessages={chatMessages}
      setchatMessages={setChatMessages}
       />
      <Chatmessages chatMessages={chatMessages} />
    
      </>
      );
    }


    
      const container = document.querySelector('.js-container');
      ReactDOM.createRoot(container).render(<App></App>);
    </script>
  </body>
</html>